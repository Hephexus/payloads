/*
 * buffer_overread_exploit.s - Buffer Overread Exploit POC.
 *
 * This exploit allocates a buffer, fills it with known data, then attempts to read more bytes
 * than allocated, demonstrating an overread.
 *
 * WARNING: This may leak adjacent memory.
 */
 
.section .bss
    .lcomm buffer, 32

.section .text
.global main
main:
    adr x0, buffer
    mov w1, #0x41   // Fill with 'A'
    mov w2, #32
fill_loop:
    cbz w2, fill_done
    strb w1, [x0], #1
    subs w2, w2, #1
    bne fill_loop
fill_done:
    mov x0, #1
    adr x1, buffer
    mov x2, #40    // Attempt to read 40 bytes from a 32-byte buffer
    mov x8, #64
    svc 0
    mov x0, #0
    mov x8, #93
    svc 0
