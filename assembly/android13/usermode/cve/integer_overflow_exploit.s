/*
 * integer_overflow_exploit.s - Integer Overflow Exploit POC.
 *
 * This exploit simulates an integer overflow in the calculation of a memory size,
 * and then uses that size in an mmap() call.
 *
 * WARNING: The calculated size may be huge.
 */
 
.section .data
message:
    .asciz "Integer Overflow Exploit Triggered!\n"

.section .text
.global main
main:
    mov w0, #0xFFFFFFFF   // Large number to force overflow
    add w0, w0, #100
    /* Use the overflowed number as the size for mmap */
    mov x0, 0            // addr = NULL
    uxtw x1, w0          // size
    mov x2, #3           // PROT_READ | PROT_WRITE
    mov x3, #0x22        // MAP_PRIVATE | MAP_ANONYMOUS
    mov x4, #-1
    mov x5, 0
    mov x8, #222
    svc 0
    mov x0, #1
    adr x1, message
    mov x2, #33
    mov x8, #64
    svc 0
    mov x0, #0
    mov x8, #93
    svc 0
