/*
 * object_injection_exploit.s - Object Injection Exploit POC.
 *
 * This exploit crafts a malicious object and, as a demonstration, writes it out to stdout.
 */
 
.section .data
crafted_object:
    .quad 0x4141414141414141
    .quad 0x4242424242424242
    .quad 0x4343434343434343

.section .text
.global main
main:
    mov x0, #1
    adr x1, crafted_object
    mov x2, #24   // 3 quadwords = 24 bytes
    mov x8, #64
    svc 0
    mov x0, #0
    mov x8, #93
    svc 0
