/*
 * syscall_dispatcher_exploit.s - Syscall Dispatcher Exploit POC.
 *
 * This module simulates modifying the syscall table by writing to a dummy table.
 *
 * WARNING: Modifying the syscall dispatcher is extremely dangerous.
 */
.extern printk
.section .bss
    .lcomm syscall_table, 64
.section .text
.global init_module
.global cleanup_module
init_module:
    adr x0, syscall_table
    mov x1, #0xBADBEEF
    str x1, [x0]
    ldr x0, =ksys_msg_activated
    bl printk
    mov x0, #0
    ret
cleanup_module:
    adr x0, syscall_table
    mov x1, #0
    str x1, [x0]
    ldr x0, =ksys_msg_deactivated
    bl printk
    ret
.section .rodata
ksys_msg_activated:
    .asciz "Kernel Exploit: Syscall Dispatcher modified\n"
ksys_msg_deactivated:
    .asciz "Kernel Exploit: Syscall Dispatcher module deactivated\n"
