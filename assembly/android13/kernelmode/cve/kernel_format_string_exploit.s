/*
 * kernel_format_string_exploit.s - Kernel Format String Exploit POC.
 *
 * This module uses a crafted format string in a call to printk to simulate uncontrolled formatting.
 *
 * WARNING: Overwriting kernel memory is dangerous.
 */
.extern printk
.section .rodata
malicious_format:
    .asciz "%x %x %x %x %x\n"
.section .text
.global init_module
.global cleanup_module
init_module:
    ldr x0, =malicious_format
    bl printk
    mov x0, #0
    ret
cleanup_module:
    ldr x0, =kfmt_msg_deactivated
    bl printk
    ret
.section .rodata
kfmt_msg_deactivated:
    .asciz "Kernel Format String Exploit module deactivated\n"
